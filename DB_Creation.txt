CREATE DATABASE SAODB;

CREATE TABLE Student (
	StudID INT PRIMARY KEY, 
	SFname VARCHAR(20) NOT NULL, 
	SLname VARCHAR(20) NOT NULL, 
	SPhone INT NOT NULL, 
	SPass VARCHAR(20)
	); 

CREATE TABLE Advisor (
	AdvID INT PRIMARY KEY, 
	AdvFname VARCHAR (20) NOT NULL, 
	AdvLname VARCHAR (20) NOT NULL, 
	AdvExt SMALLINT NOT NULL, 
	AdvPass VARCHAR (20)
	); 

CREATE TABLE Club (
	ClubId INT PRIMARY KEY,
	CName VARCHAR (30) NOT NULL, 
	CDescript VARCHAR (100) NOT NULL, 
	CcreationDate DATE NOT NULL, 
	AdvID INT REFERENCES Advisor(AdvID)
		ON UPDATE CASCADE
		ON DELETE SET NULL,
	CPresident INT REFERENCES Student(StudID)
		ON UPDATE CASCADE
		ON DELETE SET NULL,
	CVicePresident INT REFERENCES Student(StudID)
		ON UPDATE CASCADE
		ON DELETE SET NULL,
	CGeneralSecretary INT REFERENCES Student(StudID)
		ON UPDATE CASCADE
		ON DELETE SET NULL,
	CTresurer INT REFERENCES Student(StudID)
		ON UPDATE CASCADE
		ON DELETE SET NULL,
	Balance DOUBLE NOT NULL DEFAULT 4000,
	CPass VARCHAR (20)
	); 

CREATE TABLE Member (
	StudID INT REFERENCES Student (StudID)
		ON UPDATE CASCADE 
		ON DELETE CASCADE, 
	ClubId INT REFERENCES Club (ClubId)
		ON UPDATE CASCADE 
		ON DELETE NO ACTION, 
	Semester CHAR(3) NOT NULL,
	Year SMALLINT NOT NULL, 
	active TINYINT NOT NULL DEFAULT 0,
	PRIMARY KEY (StudID, ClubId)
	); 

CREATE TABLE OfficerSAO ( 
	SAOID INT PRIMARY KEY, 
	SAOFname VARCHAR (20) NOT NULL, 
	SAOLname VARCHAR (20) NOT NULL, 
	SAOExt SMALLINT NOT NULL, 
	SAOPass VARCHAR (20)
	);

CREATE TABLE Location( 
	LocID VARCHAR (10) PRIMARY KEY, 
	LocName VARCHAR (20), 
	LocRoom SMALLINT, 
	LocBldg VARCHAR (5)
); 


CREATE TABLE Event (
	EvtID INT PRIMARY KEY, 
	EvtName VARCHAR (40) NOT NULL, 
	EVTDescript VARCHAR (200) NOT NULL, 
	EVTBudget DOUBLE NOT NULL DEFAULT 0.00, 
	EVTLocation VARCHAR(10) REFERENCES Location (LocID)
		ON UPDATE CASCADE
		ON DELETE NO ACTION, 
	EVTStart DATETIME NOT NULL, 
	EVTEnd DATETIME NOT NULL, 
	AdvApproval INT REFERENCES  Advisor (AdvID) 
		ON UPDATE CASCADE
		ON DELETE NO ACTION,
	SAOApproval INT REFERENCES OfficerSAO (SAOID)
		ON UPDATE CASCADE
		ON DELETE NO ACTION
	); 


CREATE TABLE Meeting (
	MNbr INT NOT NULL, 
	ClubID INT NOT NULL, 
	MDateTime DATETIME NOT NULL, 
	MLocation VARCHAR(10) REFERENCES Location(locID)
		ON UPDATE CASCADE
		ON DELETE NO ACTION, 
	MMinutes VARCHAR(200), 
	PRIMARY KEY (MNbr, ClubID)
	); 

CREATE TABLE Attendance (
	MNbr INT NOT NULL,
	ClubID INT,
	StudID INT,
	Semester CHAR(3) NOT NULL,
	Year SMALLINT NOT NULL, 
	FOREIGN KEY(StudID, ClubId) REFERENCES Member (StudID, ClubId)
		ON UPDATE NO ACTION
		ON DELETE NO ACTION,
	FOREIGN KEY(MNbr, ClubID) REFERENCES Meeting (MNbr, ClubID)
		ON UPDATE CASCADE 
		ON DELETE CASCADE,
	PRIMARY KEY (MNbr, ClubID, StudID)
	); 




















